!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define("symboltable",["exports"],e):e(t.symboltable=t.symboltable||{})}(this,function(t){"use strict";function e(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t},n=function(){function t(t,e){for(var o=0;o<e.length;o++){var i=e[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,o,i){return o&&t(e.prototype,o),i&&t(e,i),e}}(),l=function t(e,o,r,n){i(this,t),this.key=e,this.value=o,this.color=r,this.size=n},s=function(){function t(){i(this,t)}return t.prototype._isNodeRed=function(e){return null!=e&&e.color===t.RED},t.prototype._nodeSize=function(t){return null==t?0:t.size},t.prototype.get=function(t){if(null==t)throw new ReferenceError("argument to get() is null");return this._ensureKeyHasSameType(t),0===this.size?null:this._get(this._root,t)},t.prototype.contains=function(t){return null!=this.get(t)},t.prototype.put=function(e,o){if(null==e)throw new ReferenceError("first argument to put() is null!");return this._ensureKeyHasSameType(e),null==o?void this.delete(e):(this._root=this._put(this._root,e,o),void(this._root.color=t.BLACK))},t.prototype.clear=function(){this._root=null},t.prototype.delete=function(e){if(null==e)throw new ReferenceError("argument to delete() is null!");this._ensureKeyHasSameType(e),this.contains(e)&&(null==this._root||this._isNodeRed(this._root.left)||this._isNodeRed(this._root.right)||(this._root.color=t.RED),null!=this._root&&(this._root=this._delete(this._root,e)),this.isEmpty||null==this._root||(this._root.color=t.BLACK))},t.prototype.forEach=function(t){if(null==t)throw new ReferenceError("a handler must be provided to forEach()!");this.entries.forEach(function(e){return t(e[0],e[1])})},t.prototype._get=function(t,e){for(var o=t;null!=o;)if(e.valueOf()<o.key.valueOf())o=o.left;else{if(!(e.valueOf()>o.key.valueOf()))return o.value;o=o.right}return null},t.prototype._put=function(e,o,i){return null==e?new l(o,i,t.RED,1):(o.valueOf()<e.key.valueOf()?e.left=this._put(e.left,o,i):o.valueOf()>e.key.valueOf()?e.right=this._put(e.right,o,i):e.value=i,this._isNodeRed(e.right)&&!this._isNodeRed(e.left)&&(e=this._rotateLeft(e)),this._isNodeRed(e.left)&&null!=e.left&&this._isNodeRed(e.left.left)&&(e=this._rotateRight(e)),this._isNodeRed(e.left)&&this._isNodeRed(e.right)&&this._flipColors(e),e.size=this._nodeSize(e.left)+this._nodeSize(e.right)+1,e)},t.prototype._deleteMin=function(t){return null==t||null==t.left?null:(this._isNodeRed(t.left)||null==t.left||this._isNodeRed(t.left.left)||(t=this._moveRedLeft(t)),t.left=this._deleteMin(t.left),this._balance(t))},t.prototype._delete=function(t,e){if(e.valueOf()<t.key.valueOf())this._isNodeRed(t.left)||null==t.left||this._isNodeRed(t.left.left)||(t=this._moveRedLeft(t)),null!=t.left&&(t.left=this._delete(t.left,e));else{if(this._isNodeRed(t.left)&&(t=this._rotateRight(t)),e===t.key&&null==t.right)return null;if(this._isNodeRed(t.right)||null==t.right||this._isNodeRed(t.right.left)||(t=this._moveRedRight(t)),e===t.key&&null!=t.right){var o=this._min(t.right);t.key=o.key,t.value=o.value,t.right=this._deleteMin(t.right)}else null!=t.right&&(t.right=this._delete(t.right,e))}return this._balance(t)},t.prototype._min=function(t){return null==t.left?t:this._min(t.left)},t.prototype._max=function(t){return null==t.right?t:this._max(t.right)},t.prototype._rotateRight=function(e){var o=e.left;if(null==o)throw new ReferenceError("Couldn't rotate right. Left child of h is null!");return e.left=o.right,o.right=e,o.color=o.right.color,o.right.color=t.RED,o.size=e.size,e.size=this._nodeSize(e.left)+this._nodeSize(e.right)+1,o},t.prototype._rotateLeft=function(e){var o=e.right;if(null==o)throw new ReferenceError("Couldn't rotate left. Right child of h is null!");return e.right=o.left,o.left=e,o.color=o.left.color,o.left.color=t.RED,o.size=e.size,e.size=this._nodeSize(e.left)+this._nodeSize(e.right)+1,o},t.prototype._flipColors=function(t){t.color=!t.color,null!=t.left&&(t.left.color=!t.left.color),null!=t.right&&(t.right.color=!t.right.color)},t.prototype._moveRedLeft=function(t){return this._flipColors(t),null!=t.right&&this._isNodeRed(t.right.left)&&(t.right=this._rotateRight(t.right),t=this._rotateLeft(t),this._flipColors(t)),t},t.prototype._moveRedRight=function(t){return this._flipColors(t),null!=t.left&&this._isNodeRed(t.left.left)&&(t=this._rotateRight(t),this._flipColors(t)),t},t.prototype._balance=function(t){return this._isNodeRed(t.right)&&(t=this._rotateLeft(t)),this._isNodeRed(t.left)&&null!=t.left&&this._isNodeRed(t.left.left)&&(t=this._rotateRight(t)),this._isNodeRed(t.left)&&this._isNodeRed(t.right)&&this._flipColors(t),t.size=this._nodeSize(t.left)+this._nodeSize(t.right)+1,t},t.prototype._toArray=function(t,e,o){if(null==t)throw new ReferenceError("first argument is null!");if(null==e)throw new ReferenceError("second argument is null!");var i=[];return this.__toArray(this._root,t,e,i,o),i},t.prototype.__toArray=function(t,e,o,i,r){null!=t&&(e.valueOf()<t.key.valueOf()&&this.__toArray(t.left,e,o,i,r),e.valueOf()<=t.key.valueOf()&&o.valueOf()>=t.key.valueOf()&&("key"===r?i.push(t.key):"value"===r?i.push(t.value):i.push([t.value,t.key])),o.valueOf()>t.key.valueOf()&&this.__toArray(t.right,e,o,i,r))},t.prototype._ensureKeyHasSameType=function(t){var e="Given key must be of same type as existing keys";if(0!==this.size){if("string"==typeof t&&null!=this._root&&"string"!=typeof this._root.key)throw new TypeError(e);if("boolean"==typeof t&&null!=this._root&&"boolean"!=typeof this._root.key)throw new TypeError(e);if("number"==typeof t&&null!=this._root&&"number"!=typeof this._root.key)throw new TypeError(e);if("function"==typeof t&&null!=this._root&&"function"!=typeof this._root.key)throw new TypeError(e);if("symbol"===(void 0===t?"undefined":r(t))&&null!=this._root&&"symbol"!==r(this._root.key))throw new TypeError(e);if(null!=this._root&&Object.getPrototypeOf(this._root.key)!==Object.getPrototypeOf(t))throw new TypeError(e)}},n(t,[{key:"size",get:function(){return this._nodeSize(this._root)}},{key:"isEmpty",get:function(){return null==this._root}},{key:"min",get:function(){if(this.isEmpty||null==this._root)throw new ReferenceError("Couldn't get min() for empty collection!");return this._min(this._root).key}},{key:"max",get:function(){if(this.isEmpty||null==this._root)throw new ReferenceError("Couldn't get max() for empty collection!");return this._max(this._root).key}},{key:"keys",get:function(){return 0===this.size?[]:this._toArray(this.min,this.max,"key")}},{key:"values",get:function(){return 0===this.size?[]:this._toArray(this.min,this.max,"value")}},{key:"entries",get:function(){return 0===this.size?[]:this._toArray(this.min,this.max)}}],[{key:"RED",get:function(){return!0}},{key:"BLACK",get:function(){return!1}}]),t}(),u=function(t){function r(){return i(this,r),e(this,t.apply(this,arguments))}return o(r,t),r.prototype.deleteMin=function(){if(this.isEmpty)throw new ReferenceError("Collection is empty. No element can be deleted!");null==this._root||this._isNodeRed(this._root.left)||this._isNodeRed(this._root.right)||(this._root.color=r.RED),this._root=this._deleteMin(this._root),this.isEmpty||null==this._root||(this._root.color=r.BLACK)},r.prototype.deleteMax=function(){if(this.isEmpty||null==this._root)throw new ReferenceError("Collection is empty. No element can be deleted!");this._isNodeRed(this._root.left)||null==this._root||this._isNodeRed(this._root.right)||(this._root.color=r.RED),this._root=this._deleteMax(this._root),this.isEmpty||null==this._root||(this._root.color=r.BLACK)},r.prototype.floor=function(t){if(null==t)throw new ReferenceError("argument to floor() is null!");if(this.isEmpty)throw new ReferenceError("called floor() on empty collection!");this._ensureKeyHasSameType(t);var e=this._floor(this._root,t);return null==e?null:e.key},r.prototype.ceiling=function(t){if(null==t)throw new ReferenceError("argument to ceiling() is null!");if(this.isEmpty)throw new ReferenceError("called ceiling() on empty collection!");this._ensureKeyHasSameType(t);var e=this._ceiling(this._root,t);return null==e?null:e.key},r.prototype.select=function(t){if(t<0||t>=this.size)throw new RangeError(t+" is out of bounds!");if(null==this._root)throw new ReferenceError("no root node was found in the tree. Couldn't select()");if("number"!=typeof t)throw new TypeError("argument given to select() must be of type 'number'!");return this._select(this._root,t).key},r.prototype.rank=function(t){if(null==t)throw new ReferenceError("argument to rank() is null!");return this._ensureKeyHasSameType(t),this._rank(t,this._root)},r.prototype._deleteMin=function(t){return null==t||null==t.left?null:(this._isNodeRed(t.left)||null==t.left||this._isNodeRed(t.left.left)||(t=this._moveRedLeft(t)),t.left=this._deleteMin(t.left),this._balance(t))},r.prototype._deleteMax=function(t){return null==t?null:(this._isNodeRed(t.left)&&(t=this._rotateRight(t)),null==t.right?null:(this._isNodeRed(t.right)||null==t.right||this._isNodeRed(t.right.left)||(t=this._moveRedRight(t)),t.right=this._deleteMax(t.right),this._balance(t)))},r.prototype._floor=function(t,e){if(null==t)return null;if(e.valueOf()===t.key.valueOf())return t;if(e.valueOf()<t.key.valueOf())return this._floor(t.left,e);var o=this._floor(t.right,e);return null!=o?o:t},r.prototype._ceiling=function(t,e){if(null==t)return null;if(e.valueOf()===t.key.valueOf())return t;if(e.valueOf()>t.key.valueOf())return this._ceiling(t.right,e);var o=this._ceiling(t.left,e);return null!=o?o:t},r.prototype._select=function(t,e){var o=this._nodeSize(t.left);return o>e&&null!=t.left?this._select(t.left,e):o<e&&null!=t.right?this._select(t.right,e-o-1):t},r.prototype._rank=function(t,e){return null==e?0:t.valueOf()<e.key.valueOf()?this._rank(t,e.left):t.valueOf()>e.key.valueOf()?1+this._nodeSize(e.left)+this._rank(t,e.right):this._nodeSize(e.left)},r}(s);t.SymbolTable=s,t.FullSymbolTable=u,Object.defineProperty(t,"__esModule",{value:!0})});